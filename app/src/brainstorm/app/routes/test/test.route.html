<section fxLayout="column"
         fxLayoutAlign="start stretch"
         [style.height.%]="100">
    <p class="mat-title m8">Test Rig API</p>
    <mat-progress-bar *ngIf="loading"
                      color="primary"
                      mode="indeterminate"></mat-progress-bar>
    <section *ngIf="socket"
             fxLayout="column"
             fxLayoutAlign="start stretch"
             fxFlex>
        <section *ngIf="state"
                 fxLayout="row | wrap"
                 fxLayoutAlign="start start"
                 fxLayoutGap="8px"
                 fxFlex>
            <section fxLayout="column"
                     fxLayoutAlign="start start"
                     class="p8">
                <card>
                    <p class="m4 mat-body-strong">Connection String</p>
                    <p class="m4 word-break-all">
                        {{state.connection ?? 'No Connection Retrieved'}}
                    </p>
                </card>
                <card>
                    <mat-slide-toggle [checked]="state.databaseCreated"
                                      [disabled]="loading"
                                      (change)="toggleDatabase()">
                        {{
                        state.databaseCreated
                        ? 'Destroy Database'
                        : 'Initialize Database'
                        }}
                    </mat-slide-toggle>
                </card>
                <card>
                    <mat-slide-toggle [checked]="state.processRunning"
                                      [disabled]="loading"
                                      (change)="toggleProcess()">
                        {{
                        state.processRunning
                        ? 'Kill Process'
                        : 'Start Process'
                        }}
                    </mat-slide-toggle>
                </card>
                <status-button label="Seed Topic"
                               [disabled]="loading || topic?.id > 0 || !(state.databaseCreated) || !(state.processRunning)"
                               [status]="topic?.id > 0"
                               (action)="seedTopic()"></status-button>
            </section>
            <pre class="p8 m8"><code class="color-green">{{topic | json}}</code></pre>
        </section>
        <section class="p8"
                 [style.height.px]="240"
                 [style.font-family]="'consolas'">
            <ng-container *ngIf="socket.output?.length > 0">
                <p *ngFor="let o of socket.output"
                   class="m4">{{o.output.message}}</p>
            </ng-container>
            <p *ngIf="!(socket.output?.length > 0)"
               class="m4">No Output Available</p>
        </section>
    </section>
</section>
